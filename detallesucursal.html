<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Detalle Sucursal</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    /* Estilo básico */
    body {
      font-family: 'Segoe UI', sans-serif;
      margin: 0;
      padding: 20px;
      background-color: #f4f4f4;
    }
    .detalle {
      max-width: 800px;
      margin: auto;
      background-color: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }
    .detalle img {
      width: 100%;
      height: auto;
      object-fit: contain;
      border-radius: 10px;
    }
    .detalle h1 {
      font-size: 24px;
      text-align: center;
      margin-bottom: 20px;
    }
    .detalle p {
      font-size: 16px;
      margin: 10px 0;
    }
    .detalle a {
      color: #0077cc;
      text-decoration: none;
    }
    .detalle a:hover {
      text-decoration: underline;
    }
    /* Estilo para el carrusel */
    .carrusel {
      display: flex;
      gap: 10px;
      justify-content: center;
      margin-top: 20px;
    }
    .carrusel img {
      width: 100px;
      height: 100px;
      object-fit: contain;
      cursor: pointer;
      border-radius: 8px;
      transition: opacity 0.3s ease;
    }
    .carrusel img:hover {
      opacity: 0.7;
    }
  </style>
</head>
<body>

  <div class="detalle" id="detalleSucursal">
    <h1>Cargando...</h1>
    <p>Por favor, espere mientras se cargan los detalles de la sucursal...</p>
  </div>

  <script>
    // Captura el parámetro 'sucursal' de la URL
    const urlParams = new URLSearchParams(window.location.search);
    const sucursal = urlParams.get('sucursal');

    // Verifica si el parámetro 'sucursal' existe
    if (sucursal) {
      // Llama a la API de OpenSheet que convierte la hoja "Lista CC" en JSON
      fetch("https://opensheet.elk.sh/1La-5XY4i9Ng3zpiXrre5tyAqANxpb9yuZeS8muFiZXA/Lista%20CC")
        .then(response => response.json())
        .then(data => {
          // Busca la sucursal correspondiente en el JSON
          const sucursalData = data.find(item => item['Nombre de Sucursal'] === sucursal);

          if (sucursalData) {
            // Obtén todas las imágenes de la sucursal
            let imagenes = [];
            if (sucursalData['Archivo']) {
              imagenes = sucursalData['Archivo'].split(',').map(nombre =>
                `https://raw.githubusercontent.com/piztian/SucursalesCelucenter/main/fotos/${nombre.trim()}`
              );
            }

            // Crea el HTML dinámico para la página de detalle
            document.getElementById('detalleSucursal').innerHTML = `
              <h1>Detalles de ${sucursalData['Nombre de Sucursal']}</h1>
              <img id="imagenPrincipal" src="${imagenes[0]}" alt="${sucursalData['Nombre de Sucursal']}">
              <p><strong>Dirección:</strong> ${sucursalData['Dirección'] || 'No disponible'}</p>
              <p><strong>Teléfono:</strong> ${sucursalData['Teléfono de Tienda'] || 'No disponible'}</p>
              <p><strong>Ubicación:</strong> <a href="${sucursalData['Link de Ubicación en Maps']}" target="_blank">Ver en Google Maps</a></p>
              <div class="carrusel" id="carrusel"></div>
            `;

            // Si hay más de una imagen, genera un carrusel
            if (imagenes.length > 1) {
              const carruselContainer = document.getElementById('carrusel');
              imagenes.forEach((imagen, index) => {
                const imgElement = document.createElement('img');
                imgElement.src = imagen;
                imgElement.alt = `${sucursalData['Nombre de Sucursal']} - Imagen ${index + 1}`;
                imgElement.addEventListener('click', () => {
                  // Al hacer clic en una imagen del carrusel, cambia la imagen principal
                  document.getElementById('imagenPrincipal').src = imagen;
                });
                carruselContainer.appendChild(imgElement);
              });
            }
          } else {
            document.getElementById('detalleSucursal').innerHTML = `<p>No se encontraron detalles para la sucursal ${sucursal}.</p>`;
          }
        })
        .catch(error => {
          console.error('Error al cargar los detalles:', error);
          document.getElementById('detalleSucursal').innerHTML = `<p>Hubo un problema al cargar los detalles. Por favor, inténtalo de nuevo más tarde.</p>`;
        });
    } else {
      document.getElementById('detalleSucursal').innerHTML = `<p>No se especificó una sucursal en la URL.</p>`;
    }
  </script>

</body>
</html>
